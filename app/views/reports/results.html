<div id="report-result">
  <div id="header-container">
    <h1 class="pull-left">{{reportsBase.results.selectedReportExecution.title}}</h1>
  </div>
  <div id="page-contents" class="no-footer with-header-container">
    <div id="associatedTable" ng-class="associatedTableExpand ? 'expand-table' : ''" class="">
      <div class="container_24 no_margin">
        <div class="grid_22 alpha">
          <table class="striped compact">
            <thead>
            <tr>
              <th><%= t('reports.results.sorted_by') %></th>
              <th style="width: 350px;"><%= t('reports.results.date_range') %></th>
              <th><%= t('reports.results.data_type') %></th>
              <th><%= t('reports.results.data_name') %></th>
            </tr>
            <tr>
              <td>
                <span ng-repeat="sorted in reportsBase.results.selectedReportExecution.report_definition.sorted_by">{{sorted.frontend_name}}{{$last ? '' : ', '}}</span>
              </td>
              <td>
                <span>{{getStartEndDatesFromResults()}}</span>
              </td>
              <td>
                <span ng-repeat="data in reportsBase.results.selectedReportExecution.report_grouping">{{data.data_type}}{{$last ? '' : ', '}}</span>
              </td>
              <td>
                <span ng-repeat="data in reportsBase.results.selectedReportExecution.report_grouping">{{data.data_name}}{{$last ? '' : ', '}}</span>
              </td>
            </tr>
            </thead>
          </table>
        </div>
        <div class="grid_2 omega pull-right">
          <a class="button pull-right" ng-click="associatedTableExpand = !associatedTableExpand">
            <i class="fa" ng-class="{'fa-expand':!associatedTableExpand,'fa-compress':associatedTableExpand}"></i>
          </a>
        </div>
      </div>
    </div>
    <div class="section full-screen-table">
      <div class="filter" id="rules-filter">
        <ul>
          <li class="search-form no-filter-button">
            <form>
              <input id="report-result-search" type="text" class="form-control" placeholder="<%= t('search.search') %>" ng-model="reportsBase.filter.search"
                     tooltip="<%= t('reports.results.tooltip') %>" tooltip-placement="left"
                     tooltip-trigger="focus"
                     autofocus="autofocus">
              <span id="search-clear" class="glyphicon glyphicon-remove-circle" ng-click="clearSearch()"
                    ng-if="reportsBase.filter.search"></span>

              <div class="input-group-addon search-button button" ng-click="loadFilters()" type="submit"><i
                class="fa fa-search"></i>
              </div>
            </form>
          </li>
        </ul>
        <ul class="filter-list">
        </ul>
      </div>
      <div class="content-panel" style="width:100%;">
        <div class="table-wrapper" auto_table_width loading urls="/results">
          <table>
            <thead>
            <tr>
              <th ng-repeat="header in reportsBase.results.data.headers" ng-class="header.value" auto_column_width>
                {{header.frontend_name}}
              </th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="row in reportsBase.results.data.results | filter:filter.search">
              <td id="name{{$index}}" ng-repeat="header in reportsBase.results.data.headers">{{row[header.value]}}</td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="action-bar primary">
      <ul>
        <li>
          <a id="back-reports" href="/reports" class="button neutral">
            <%=t('generic_buttons.back')%>
          </a>
        </li>
        <li>
          <a id="export-report" href="{{getExecID()}}" target="_self" class="button">
            <%=t('reports.results.export_as_csv')%>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>
